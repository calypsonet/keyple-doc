# Keyple website maintenance guide 

The Keyple website is generated with [Hugo](https://gohugo.io/), the open-source static site generator.

It uses the [Docsy](https://www.docsy.dev/) theme.

It is recommended that you work from the command line in a Linux or Windows console (Git Bash).

## Building and running the site locally
#### Install Hugo

Follow the instructions given here : https://www.docsy.dev/docs/getting-started/

Make sure you choose the extended version of **Hugo** and install the additional modules ```PostCSS``` and ```autoprefixer``` locally to the current folder (```npm install postcss-cli``` and ```npm install autoprefixer```).

#### Clone the website source from the ```website-master``` branch to a local folder.
```
git clone -b website-master https://github.com/calypsonet/keyple-doc.git
cd keyple-doc
```
~git submodule update --init --recursive~

~*Note: a decent version of git is required (capable of handling sub-modules).*~

#### Run Hugo server

Launch the local Hugo web server:
```
hugo server -v
```

#### Open the site in a browser

Web server is available at http://localhost:1313/keyple-website/ (bind address 127.0.0.1)

## Modifying the site and debugging the rendering

* The site parameters (URLs, home page layout, etc) are defined in the file ```config.toml```.
* The pages of the site are contained in ```.md``` files in the ```content``` folder.

For details of the Hugo/Docsy layout possibilities refer to https://www.docsy.dev/docs/adding-content/.

## Publishing the site

The publication of the site consists of placing the code generated by Hugo in the ```gh-pages``` branch of the Github repository.

### Generate the static pages with Hugo

Just run ```hugo``` (without argument) at the root of the folder.

### Update the remote branches

Update the local git repository for example with the following commands:
```
git add .
```
to add the changes made to the list of files to be updated in the repository.
```
git commit -m "Comment describing the changes"
```

Push the source code in ```website-master``` and ```gh-pages``` branches.

These operations are executable in a single operation with the ```deploy_keyple_website.sh``` script.

Changes will be visible online a few minutes after the branch update.

In case the deployment script shows an error due to desynchronization between the local repository and the github repository (this case happens when you edited a file directly online on github.com), it is necessary to update the local repository with the command:
```
git pull origin website-master
```
